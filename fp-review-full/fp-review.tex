\documentclass{zarticle}
\addbibresource{fp-review.bib}
\definecolor{todocolor}{RGB}{127,0,0}
\def\todo#1{{\color{todocolor}\bfseries [#1]}}
\def\needcite#1{\todo{cite: #1}}
\begin{document}

\title{Unmasking Web Users and Activities:
  A review of the literature on traffic analysis of the modern Internet}
\author{Zachary Weinberg}
\date{\today}
\maketitle

\begin{abstract}
Abstract abstract, abstract abstract abstract.
\end{abstract}

\section{Introduction}

Most off-the-shelf secure network protocols provide some form of the
conceptual \emph{secure channel} for passing messages back and forth
between two endpoints.  A secure channel offers three security
guarantees: \emph{confidentiality}---an attacker cannot observe the
content of messages in transit; \emph{integrity}---an attacker cannot
modify messages in transit; and \emph{authenticity}---an attacker
cannot impersonate either endpoint.  These guarantees collectively
offer a solid foundation for secure application development, but they
are not sufficient for complete security in all situations.

\subsection{Unlinkable Channels}

Even with a secure channel in place, an eavesdropper can easily learn
the origin and destination addresses of each packet, the amount of
application data it carries, its position within a TCP stream, and
other metainformation, such as any TCP options that are present.  Of
this information, the origin and destination are most sensitive;
sometimes the information that Alice did at some point talk to Bob is
enough to send Alice to prison!\footnote{As an extreme example, the
  Soviet Union notoriously criminalized “contacts leading to suspicion
  of espionage.”~\cite{solzh74gulag:svpsh}}  An \emph{unlinkable
  channel} is a secure channel that passes through one or more relay
hosts, so that an eavesdropper at any single point in the network
cannot tell that the endpoints are communicating with each other.  At
most, the eavesdropper will know that one of the endpoints is
communicating with one of the relays.  This is the additional security
guarantee of \emph{unlinkability}~\cite{pfitzmann2010terminology}.

The secure channel within an unlinkable channel is established
end-to-end, so the relay(s) cannot themselves eavesdrop; however, if
there is only one relay (this style of unlinkable channel is commonly
known as a \emph{proxy server}), the relay itself knows both the
source and the destination of each message.  Even if run by people
with the best of intentions, a proxy server is vulnerable to coercion
to expose that information.\footnote{As a less extreme example, the
  email relay \textsf{anon.penet.fi} shut down under ongoing legal
  pressure to unmask its users.~\cite{newman1996church}} A \emph{mix
  network}~\cite{chaum1981mix} replaces the single relay with a chain
of relays, each of which knows only the previous and next hop;
subverting any one relay thus reveals no more than eavesdropping would
have.  In practice, three relays are used, because a two-relay chain
is insufficient to defend against attacks by pairs of colluding
malicious relays, but a chain of four or more relays offers only
marginal additional security at substantial cost in
latency.~\cite{wright2002analysis,wright2003defending} Some of the
research we review studied the behavior of proxy servers, while other
papers examined mix networks.  We will refer to both as unlinkable
channels except where the difference matters.

Unlinkable channels don't generally conceal the size or the timing of
messages.  There are exceptions: Chaum's original mix design (intended
for email) did include substantial delays at each relay in order to
conceal timing, but this is not considered acceptable for modern
interactive protocols such as HTTP: current-generation mix networks,
such as Tor~\cite{dingledine2004tor}, treat their \emph{low latency}
as a valuable feature.  Unlinkable channels may or may not disguise
the TCP session to which each packet belongs.

\subsection{Traffic Analysis}

Traffic analysis is the craft of deducing information about the
content of a secret message from what is still observable.
Classically, this was its origin, destination, timing, and
relationship to other events: for instance, if we overhear an
encrypted radio message directed to a naval base, and shortly
thereafter an aircraft carrier group leaves that base, we can deduce
that the message was orders for that carrier group.  In a modern
packet-switched network, traffic analysis relies on message size and
timing.  Packet sizes may be used directly, or may be aggregated to
estimate the size of a higher-level message, such as an HTTP
transaction.  TCP control bits can also reveal higher-level message
boundaries.

There are a wide variety of threat models in the literature for
traffic-analytic attackers on unlinkable channels.  The attacker may
be located at several different places within the network, and may
have one, two, or several listening posts.  It may be strictly an
eavesdropper, or may be allowed to generate its own traffic, or may
even operate its own malicious relays.  It may be able to communicate
overtly with its victims, for instance by enticing them to visit an
attacker-controlled website; this is more powerful than it might
sound, since a malicious website can execute code (in a restricted,
but not at all foolproof, environment) on its victims'
computers.~\cite{barth2008securing} However, “Byzantine” attacks, in
which the attacker interferes with the correct operation of the
unlinkable channel protocol, are considered a separate class of
threat.  The attacker's goals are even more diverse, ranging from
the deduction of encrypted channel content to tracing messages through
the relay chain to identifying communicants.

\subsection{Website Fingerprinting}

This review focuses on two classes of traffic analysis attacks, both
of which are referred to in the literature as “website
fingerprinting.”  Both feature an attacker eavesdropping on a
victim-user at or near the victim's location in the network;
specifically, the attacker is assumed to be able to observe traffic
between the victim's computer and the first relay in the unlinkable
channel.  Therefore, the attacker already knows something about the
victim, and their goal is to learn something about what they are using
the unlinkable channel for.  (One result discussed
below~\cite{gong2011fingerprinting} suggests the possibility of
fingerprinting from afar by flooding the victim with ICMP “ping”
messages, but the traffic so observed is still the traffic between the
victim's computer and the first relay.)  In one class of
fingerprinting attacks, the attacker simply seeks to determine which
Web sites the victim is browsing via the unlinkable channel.  In the
other class, the attacker assumes that the victim is browsing a
particular website, and attempts to learn something about what they're
doing there.

\section{Identifying Websites}

The Web being the most common application layer use of the modern
Internet, it is a safe bet that the victim is using it; however, for
the same reason, the number of possible sites that the victim might be
browsing is enormous.  Most published attacks of this form limit
themselves to a relatively small number of sites, usually the most
popular 100 to 10,000, either based on local traffic sampling, or the
global rankings published by Alexa.  These are not terribly realistic
when one considers \emph{why} the attacker might want to know which
sites their victim browses; we will come back to this point later.

\subsection{Laboratory-scale experiments}

\subsection{Larger experiments}

\section{Identifying Activity}

\subsection{Unmasking Users of Social Networks}

The data stream that these sites produce when loaded is predictable,
and more importantly, has predictable variation that depends on, for
instance, the file size of the victim's profile photo, which may well
uniquely identify the victim.  (The attacker knows the address of the
victim's computer, but that doesn't mean they already know the
victim's Facebook account ID.)  These attacks are more realistic, but
since they only look at data coming from one site, application-level
countermeasures are feasible.

\section{Countermeasures}

\section{Related attacks}

\section{Discussion}

\printbibliography
\end{document}
